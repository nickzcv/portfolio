{"ast":null,"code":"/* Constants */\nconst DOWN_EVENT = 1;\nconst MOVE_EVENT = 2;\nconst UP_EVENT = 4;\nconst MOUSE_EVENTS = {\n  pointerdown: DOWN_EVENT,\n  pointermove: MOVE_EVENT,\n  pointerup: UP_EVENT,\n  mousedown: DOWN_EVENT,\n  mousemove: MOVE_EVENT,\n  mouseup: UP_EVENT\n}; // MouseEvent.which https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/which\n\nconst MOUSE_EVENT_WHICH_LEFT = 1;\nconst MOUSE_EVENT_WHICH_MIDDLE = 2;\nconst MOUSE_EVENT_WHICH_RIGHT = 3; // MouseEvent.button https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/button\n\nconst MOUSE_EVENT_BUTTON_LEFT = 0;\nconst MOUSE_EVENT_BUTTON_MIDDLE = 1;\nconst MOUSE_EVENT_BUTTON_RIGHT = 2; // MouseEvent.buttons https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/buttons\n\nconst MOUSE_EVENT_BUTTONS_LEFT_MASK = 1;\nconst MOUSE_EVENT_BUTTONS_RIGHT_MASK = 2;\nconst MOUSE_EVENT_BUTTONS_MIDDLE_MASK = 4;\n/**\n * Extract the involved mouse button\n */\n\nexport function whichButtons(event) {\n  const eventType = MOUSE_EVENTS[event.srcEvent.type];\n\n  if (!eventType) {\n    // Not a mouse evet\n    return null;\n  }\n\n  const {\n    buttons,\n    button,\n    which\n  } = event.srcEvent;\n  let leftButton = false;\n  let middleButton = false;\n  let rightButton = false;\n\n  if ( // button is up, need to find out which one was pressed before\n  eventType === UP_EVENT || // moving but does not support `buttons` API\n  eventType === MOVE_EVENT && !Number.isFinite(buttons)) {\n    leftButton = which === MOUSE_EVENT_WHICH_LEFT;\n    middleButton = which === MOUSE_EVENT_WHICH_MIDDLE;\n    rightButton = which === MOUSE_EVENT_WHICH_RIGHT;\n  } else if (eventType === MOVE_EVENT) {\n    leftButton = Boolean(buttons & MOUSE_EVENT_BUTTONS_LEFT_MASK);\n    middleButton = Boolean(buttons & MOUSE_EVENT_BUTTONS_MIDDLE_MASK);\n    rightButton = Boolean(buttons & MOUSE_EVENT_BUTTONS_RIGHT_MASK);\n  } else if (eventType === DOWN_EVENT) {\n    leftButton = button === MOUSE_EVENT_BUTTON_LEFT;\n    middleButton = button === MOUSE_EVENT_BUTTON_MIDDLE;\n    rightButton = button === MOUSE_EVENT_BUTTON_RIGHT;\n  }\n\n  return {\n    leftButton,\n    middleButton,\n    rightButton\n  };\n}\n/**\n * Calculate event position relative to the root element\n */\n\nexport function getOffsetPosition(event, rootElement) {\n  const center = event.center; // `center` is a hammer.js event property\n\n  if (!center) {\n    // Not a gestural event\n    return null;\n  }\n\n  const rect = rootElement.getBoundingClientRect(); // Fix scale for map affected by a CSS transform.\n  // See https://stackoverflow.com/a/26893663/3528533\n\n  const scaleX = rect.width / rootElement.offsetWidth || 1;\n  const scaleY = rect.height / rootElement.offsetHeight || 1; // Calculate center relative to the root element\n\n  const offsetCenter = {\n    x: (center.x - rect.left - rootElement.clientLeft) / scaleX,\n    y: (center.y - rect.top - rootElement.clientTop) / scaleY\n  };\n  return {\n    center,\n    offsetCenter\n  };\n}","map":{"version":3,"sources":["../../../src/utils/event-utils.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["/* Constants */\nconst DOWN_EVENT = 1;\nconst MOVE_EVENT = 2;\nconst UP_EVENT = 4;\nconst MOUSE_EVENTS = {\n    pointerdown: DOWN_EVENT,\n    pointermove: MOVE_EVENT,\n    pointerup: UP_EVENT,\n    mousedown: DOWN_EVENT,\n    mousemove: MOVE_EVENT,\n    mouseup: UP_EVENT\n};\n// MouseEvent.which https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/which\nconst MOUSE_EVENT_WHICH_LEFT = 1;\nconst MOUSE_EVENT_WHICH_MIDDLE = 2;\nconst MOUSE_EVENT_WHICH_RIGHT = 3;\n// MouseEvent.button https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/button\nconst MOUSE_EVENT_BUTTON_LEFT = 0;\nconst MOUSE_EVENT_BUTTON_MIDDLE = 1;\nconst MOUSE_EVENT_BUTTON_RIGHT = 2;\n// MouseEvent.buttons https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/buttons\nconst MOUSE_EVENT_BUTTONS_LEFT_MASK = 1;\nconst MOUSE_EVENT_BUTTONS_RIGHT_MASK = 2;\nconst MOUSE_EVENT_BUTTONS_MIDDLE_MASK = 4;\n/**\n * Extract the involved mouse button\n */\nexport function whichButtons(event) {\n    const eventType = MOUSE_EVENTS[event.srcEvent.type];\n    if (!eventType) {\n        // Not a mouse evet\n        return null;\n    }\n    const { buttons, button, which } = event.srcEvent;\n    let leftButton = false;\n    let middleButton = false;\n    let rightButton = false;\n    if (\n    // button is up, need to find out which one was pressed before\n    eventType === UP_EVENT ||\n        // moving but does not support `buttons` API\n        (eventType === MOVE_EVENT && !Number.isFinite(buttons))) {\n        leftButton = which === MOUSE_EVENT_WHICH_LEFT;\n        middleButton = which === MOUSE_EVENT_WHICH_MIDDLE;\n        rightButton = which === MOUSE_EVENT_WHICH_RIGHT;\n    }\n    else if (eventType === MOVE_EVENT) {\n        leftButton = Boolean(buttons & MOUSE_EVENT_BUTTONS_LEFT_MASK);\n        middleButton = Boolean(buttons & MOUSE_EVENT_BUTTONS_MIDDLE_MASK);\n        rightButton = Boolean(buttons & MOUSE_EVENT_BUTTONS_RIGHT_MASK);\n    }\n    else if (eventType === DOWN_EVENT) {\n        leftButton = button === MOUSE_EVENT_BUTTON_LEFT;\n        middleButton = button === MOUSE_EVENT_BUTTON_MIDDLE;\n        rightButton = button === MOUSE_EVENT_BUTTON_RIGHT;\n    }\n    return { leftButton, middleButton, rightButton };\n}\n/**\n * Calculate event position relative to the root element\n */\nexport function getOffsetPosition(event, rootElement) {\n    const center = event.center;\n    // `center` is a hammer.js event property\n    if (!center) {\n        // Not a gestural event\n        return null;\n    }\n    const rect = rootElement.getBoundingClientRect();\n    // Fix scale for map affected by a CSS transform.\n    // See https://stackoverflow.com/a/26893663/3528533\n    const scaleX = rect.width / rootElement.offsetWidth || 1;\n    const scaleY = rect.height / rootElement.offsetHeight || 1;\n    // Calculate center relative to the root element\n    const offsetCenter = {\n        x: (center.x - rect.left - rootElement.clientLeft) / scaleX,\n        y: (center.y - rect.top - rootElement.clientTop) / scaleY\n    };\n    return { center, offsetCenter };\n}\n//# sourceMappingURL=event-utils.js.map"]},"metadata":{},"sourceType":"module"}